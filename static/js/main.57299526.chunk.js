(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},102:function(e,t,a){},120:function(e,t,a){},235:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(56),i=a.n(r),o=(a(100),a(32)),l=a(33),c=a(37),u=a(34),d=a(36),g=(a(59),a(102),a(244)),p=a(247),m=a(249),h=a(35),b=h.apps.length?h.app():h.initializeApp({apiKey:"AIzaSyDdSZHCO81Uv6xfidO1l_e_OB-piEMDPC8",authDomain:"nyes-debuy.firebaseapp.com",databaseURL:"https://nyes-debuy.firebaseio.com",projectId:"nyes-debuy",storageBucket:"nyes-debuy.appspot.com",messagingSenderId:"681496751980"}),y=a(6),S=a.n(y),f=a(12),k=a(21),v=a(18),M=a(241),E=a(242),x=a(248),C=a(243),O=a(246),A=a(245),j=(a(120),a(29)),D=a.n(j),B=(a(122),a(22)),w=a.n(B),P=a(91),L=a.n(P),R=a(25),W=a.n(R),_=a(47),N=(a(124),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleLoginChange=function(e){a.setState(Object(k.a)({},e.target.id,e.target.value))},a.handleLoginSubmit=function(){var e=Object(f.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a.login();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.admin=b.database().ref().child("admin"),a.endSession=Object(f.a)(S.a.mark(function e(){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.admin.child("endSession").transaction(function(e){return!0,!0});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)})),a.collectResources=Object(f.a)(S.a.mark(function e(){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.admin.child("collectResources").transaction(function(e){return!0,!0});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)})),a.addUser=Object(f.a)(S.a.mark(function e(){var t,n,s,r,i,o,l,c,u,d,g;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.database().ref("/users"),console.log("READY TO GET DATA "+n.key),e.next=4,n.once("value").then(function(e){s=e.val(),this.setState({userData:s})}.bind(Object(v.a)(Object(v.a)(a))));case 4:return"wJDQPljys8V4FcDaQ0MXz2lkXnE2",t={ldhHkXv1FHVcOUoPr6Fbyw96RK73:!1,dSpPJ8yMcxX95POZym5bQ0HiUp12:!1,Qmt84HLPdzbzSpEvZ35gyrWZNcd2:!1,KRXuP4eVOnee2NeZP6j6Am2VDUo1:!1,WbCmmW4gbCQ274HpaKDKxkTFqJJ2:!1,"5cZOpOpQJZUSO0jpK2jppJmeuUk1":!1,mfTsZpW40jQC3foXlXNt6Nkfct42:!1,XCPTnPUspTR7rFm5siD5zx8Bitt1:!1,QBmimm6MjleJJSam1LCwJzxToHb2:!1,BujUWydEKvdrMeI9FA4fJHkA6rs2:!1,rFwlDfzgYXVcu0tpqnilFhIjvA93:!1,"4iVAQmJyhnOTThnDqZo5BGaG8zq2":!1,HwkZBJmCdHOgtsWsQMdlX4EJWOF2:!1,vTHdq2g16Qa4rqrpIFCN9v2ntLA3:!1,VHVlVL3SJbVa8Tug8Ifo3rEKziN2:!1,rWbYOvVTZsargFTIrprApp07s0O2:!1,Ol4qjqkxHaNLuDQkxiddBrAu17f2:!1,"7iCTyGi3RTPXOwEzzUeqnhDrriO2":!1,sLQy90XzIUMS3AtOnokn6mn5pmH2:!1,"2HYrQPgSGcT7dbB8Y7CRzHmWo4B3":!1,Pl6hKa2P9rSLF30lEWBkMQEOgmQ2:!1,zLWlGETNE7hbRhdGXKCUeJXz1Id2:!1,"1EffukgxMsYYuJuMc2S76t9sPbL2":!1,dM2uAP5aLJgyJRI43gjfhhKWFko1:!1,dnj8jkePMSfUpULW7QD7pNX0IyJ2:!1,tNgxEKD7WrXrVF4gYwDbwRuIpqj2:!1,SVjlZCGqVXP2S4CWH1s5u3JJJXz1:!1,Bh1Q8WUkincGvCtccDNTEVeJNoc2:!1},Object(k.a)(t,"Bh1Q8WUkincGvCtccDNTEVeJNoc2",!1),Object(k.a)(t,"SVjlZCGqVXP2S4CWH1s5u3JJJXz1",!1),Object(k.a)(t,"KFp55sh2h2O7Ps4QolRkkU6tVb92",!0),Object(k.a)(t,"wJDQPljys8V4FcDaQ0MXz2lkXnE2",!0),r=t,i=Object.keys(r),o=[],i.forEach(function(){var e=Object(f.a)(S.a.mark(function e(t){var a,s;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.child(t).transaction(function(e){return{create:!1,human:0,humanAvailable:0,land:50,landAvailable:11,buildList:{},GDP:{human:0,import:0,export:0,comsumption:0,govern:0},historyData:{GDP:[]},comsumption:{demand:{Wood:0},minD:{Wood:0},supply:{Vegetable:0,Meat:0,"Processed Vegetable":0,"Processed Meat":0}},building:{Wood:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Sand:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Steel:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Rubber:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Cotton:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Oil:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Leather:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Copper:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Silver:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Vegetable:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Meat:[{level:0,input:{human:0,Money:0},upgrade:!1,mortgage:!1}],Car:[],Shirt:[],"Processed Vegetable":[],"Processed Meat":[],"Solar Panel":[],Furniture:[],Jewellery:[],Gloves:[],Bag:[],Gadget:[],Book:[]},resources:{Money:75e4,Wood:0,Sand:0,Steel:0,Rubber:0,Cotton:0,Oil:0,Leather:0,Copper:0,Silver:0,Vegetable:0,Meat:0,Car:0,Shirt:0,"Processed Vegetable":0,"Processed Meat":0,"Solar Panel":0,Furniture:0,Jewellery:0,Gloves:0,Bag:0,Gadget:0,Book:0},specialBuilding:{Education:{level:0,upgrade:!1},Telecommunication:{level:2,upgrade:!1},Healthcare:{level:0,upgrade:!1}},tradepool:{Money:0}}});case 2:return a=e.sent,e.next=5,b.database().ref("/resourcesMatrix/"+t).transaction(function(e){return _.Master.initialMatrix});case 5:s=e.sent,o.push(a.committed&&s.committed);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),l=!0,o.forEach(function(e){e||(l=!1)}),console.log("Add Users Completed "+l),e.next=14,b.database().ref("/idToName");case 14:return c=e.sent,e.next=17,c.remove();case 17:return u=e.sent,console.log("idToName "+u),e.next=21,b.database().ref("/trade");case 21:return d=e.sent,e.next=24,d.remove();case 24:g=e.sent,console.log("trade "+g);case 26:case"end":return e.stop()}},e,this)})),a._onSelectNation1=function(e){e!=a.state.nationChosen1&&a.setState({nation:[],rules:[],contracting:!1}),a.setState({nationChosen1:e})},a._onSelectNation2=function(e){e!=a.state.nationChosen2&&a.setState({nation:[],rules:[],contracting:!1}),a.setState({nationChosen2:e})},a.validation=function(){if(null!=a.state.nationChosen1&&null!=a.state.nationChosen2)return a.state.nationChosen1.value==a.state.nationChosen2.value?s.a.createElement(M.a,null,"Plaese choose valid nation set"):(a.nation.includes(a.state.nationChosen1)&&a.nation.includes(a.state.nationChosen2)||(a.nation=[],a.target=[]),s.a.createElement(M.a,null,s.a.createElement(E.a,{xs:2,md:2,lg:2}),s.a.createElement(E.a,{xs:4,md:4,lg:4},s.a.createElement("form",{onSubmit:null},s.a.createElement(x.a,{controlId:"id",bsSize:"small"},s.a.createElement(C.a,null,"contract id"),s.a.createElement(O.a,{value:a.state.id,onChange:a._handleIDChange})))),s.a.createElement(E.a,{xs:4,md:4,lg:4},s.a.createElement(A.a,{className:"Button",bsStyle:"warning",bsSize:"small",onClick:function(){return a.contract()}},"Start Contract")),s.a.createElement(E.a,{xs:2,md:2,lg:2})))},a._handleIDChange=function(e){a.setState(Object(k.a)({},e.target.id,e.target.value))},a._handleExpiryChange=function(e){a.setState(Object(k.a)({},e.target.id,parseInt(e.target.value)))},a._handlePenaltyChange=function(e){a.setState(Object(k.a)({},e.target.id,parseInt(e.target.value)))},a.__selectNation=function(e){a.setState({from:e})},a.__selectTarget=function(e){a.setState({to:e})},a.__selectResouce=function(e){a.setState({resource:e})},a.initiateRules=Object(f.a)(S.a.mark(function e(){var t,n,s;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.id,console.log(t.length),n=b.database().ref().child("contract/"+t),e.next=5,n.transaction(function(e){return(e={}).parties={},e.parties[this.state.nationChosen1.value]=!1,e.parties[this.state.nationChosen2.value]=!1,e.timestamp=Date.now(),e.start=this.state.session+1,e.expiry=this.state.expiry,e.penalty=this.state.penalty,e.rules=[],this.state.rules.map(function(t){var a={};a.for=t.from.value,a.target=t.target.value,a.resource=t.resource.value,e.rules.push(a)}),console.log(JSON.stringify(e)),e}.bind(Object(v.a)(Object(v.a)(a))));case 5:s=e.sent,a.nation=[],a.target=[],s.committed?(alert("Contract have been added"),a.setState({rules:[],nationChosen1:null,nationChosen2:null,contracting:!1})):alert("Please send again!!!");case 9:case"end":return e.stop()}},e,this)})),a.renderContractList=function(e){console.log("PROPS "+JSON.stringify(Object.keys(e)));var t=e.data,n=Object.keys(t.parties);return console.log(a.nationMap+"  "+n),console.log(a.nationMap[n[0]]),s.a.createElement("div",{key:e.theKey},s.a.createElement(L.a,{className:"ListTile"},s.a.createElement(w.a,{container:!0,spacing:16},s.a.createElement(w.a,{item:!0,xs:12,sm:!0,container:!0},s.a.createElement(w.a,{item:!0,xs:!0,container:!0,direction:"column",spacing:16},s.a.createElement(w.a,{item:!0,xs:!0},s.a.createElement(W.a,{gutterBottom:!0,variant:"subtitle1",style:{fontSize:18}},"CONTRACT ID : ",e.theKey),s.a.createElement(W.a,{gutterBottom:!0,style:{fontSize:15}},"Contract Expiry : "+t.expiry+" session"),s.a.createElement(W.a,{color:"textSecondary",style:{fontSize:15}},"Penalty: "+JSON.stringify(t.penalty)))),s.a.createElement(w.a,{item:!0},s.a.createElement(w.a,{item:!0},t.parties[n[0]]?s.a.createElement(A.a,{bsStyle:"success",bsSize:"small",onClick:function(){return a.contractRuin(e.theKey,n[0],n[1])},disabled:!1},a.nationMap[n[1]].name," call penalty"):s.a.createElement(W.a,{variant:"subtitle1",style:{fontSize:15}},a.nationMap[n[1]].name)),s.a.createElement(w.a,{item:!0},t.parties[n[1]]?s.a.createElement(A.a,{bsStyle:"success",bsSize:"small",onClick:function(){return a.contractRuin(e.theKey,n[1],n[0])},disabled:!1},a.nationMap[n[0]].name," call penalty"):s.a.createElement(W.a,{variant:"subtitle1",style:{fontSize:15}},a.nationMap[n[0]].name)),s.a.createElement(w.a,{item:!0},s.a.createElement(A.a,{bsStyle:"success",bsSize:"small",onClick:function(){return a.endContractByOne(e.theKey,n[0])}},a.nationMap[n[0]].name," TERMINATE"),s.a.createElement(A.a,{bsStyle:"success",bsSize:"small",onClick:function(){return a.endContractByOne(e.theKey,n[1])}},a.nationMap[n[1]].name," TERMINATE"),s.a.createElement(A.a,{bsStyle:"success",bsSize:"small",onClick:function(){return a.endContract(e.theKey)}},"BOTH TERMINATE")))))))},a.data=b.database().ref("/users"),a.admin=b.database().ref().child("admin"),a.contractList={},a.nationMap={},a.nationOptions=[],a.nation=[],a.target=[],a.state={nationChosen1:null,nationChosen2:null,id:"",rules:[],contracting:!1,expiry:0,penalty:0,from:null,to:null,resource:null,email:"",password:"",login:!1,seconds:0,session:0,userData:!1,rMatrix:{},tradeData:_.initialTradeData},a.routePush=a.routePush.bind(Object(v.a)(Object(v.a)(a))),a.endSession=a.endSession.bind(Object(v.a)(Object(v.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"checkCurrentUser",value:function(){var e=Object(f.a)(S.a.mark(function e(){var t=this;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.auth().onAuthStateChanged(function(e){null!=e?(t.setState({currentUser:e,login:!0}),console.log(e.email),e.getIdTokenResult().then(function(e){console.log(e.claims.admin)}),console.log("We are authenticated now!"),t.tradeListener()):console.log("login out")}),console.log("login? "+this.state.login);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"validateLoginForm",value:function(){return this.state.email.length>0&&this.state.password.length>0}},{key:"login",value:function(){var e=Object(f.a)(S.a.mark(function e(){var t=this;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOGIN"),b.auth().signInWithEmailAndPassword(this.state.email,this.state.password).then(function(e){t.setState({currentUser:e.user,login:!0}),e.user.getIdTokenResult().then(function(e){console.log(e.claims.admin)})}).then(function(){this.tradeListener()}.bind(this));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){b.auth().signOut(),console.log("Sign Out"),this.setState({login:!1})}},{key:"componentWillMount",value:function(){this.checkCurrentUser(),this.nationListListener(),this.sessionListener(),this.contractListener(),console.log("set completed")}},{key:"updatePrice",value:function(){var e=Object(f.a)(S.a.mark(function e(t,a,n){var s,r;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=b.database().ref().child("trade").child(n+"/data/"+t),e.next=3,s.transaction(function(e){return a});case 3:r=e.sent,console.log("price updated : "+r.committed);case 5:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"nationListListener",value:function(){var e=this;b.database().ref().child("idToName").on("child_added",function(t){e.nationOptions.push({value:t.key,label:t.val().name}),e.nationMap[t.key]=t.val(),e.setState({})})}},{key:"sessionListener",value:function(){var e=this;console.log("SET session listener"),b.database().ref().child("session").on("value",function(t){e.setState({session:t.val()}),Object.keys(e.contractList).forEach(function(t){e.contractList[t].expiry<e.state.session&&delete e.contractList[t]})})}},{key:"contractListener",value:function(){var e=this;console.log("SET COntract listener");var t=b.database().ref().child("contract");t.on("child_added",function(t){console.log("contract "+t.key),t.val().expiry>=e.state.session&&(e.contractList[t.key]=t.val(),e.setState({}))}),t.on("child_changed",function(t){Object.keys(t.val().parties);t.val().expiry>=e.state.session?(e.contractList[t.key]=t.val(),e.setState({})):delete e.contractList[t.key]}),t.on("child_removed",function(t){delete e.contractList[t.key]})}},{key:"tradeListener",value:function(){var e=this,t=b.database().ref().child("trade");Object.keys(this.state.tradeData).forEach(function(a){var n=t.child(a+"/data"),s=t.child(a+"/Bid"),r=t.child(a+"/Ask");n.on("child_added",function(t){e.state.tradeData[a].price[t.key]=t.val()},function(e){return console.log("trade data "+e)}),n.on("child_changed",function(t){console.log("price change"),e.state.tradeData[a].price[t.key]=t.val()},function(e){return console.log("trade data "+e)}),s.on("child_added",function(t){if(e.state.tradeData[a].Bid[t.key]=t.val(),0==e.state.tradeData[a].bids.length)e.state.tradeData[a].bids.push(t.key),e.updatePrice("BidPrice",t.val().price,a);else{for(var n=!1,s=e.state.tradeData[a].bids.length,r=0;r<s;r++)if(t.val().price>e.state.tradeData[a].Bid[e.state.tradeData[a].bids[r]].price){e.state.tradeData[a].bids.splice(r,0,t.key),n=!0,0==r&&e.updatePrice("BidPrice",t.val().price,a);break}n||e.state.tradeData[a].bids.push(t.key)}},function(e){return console.log("trade bid "+e)}),s.on("child_changed",function(t){e.state.tradeData[a].Bid[t.key]=t.val()},function(e){return console.log("trade bid "+e)}),s.on("child_removed",function(t){e.state.tradeData[a].Bid[t.key]=void 0;for(var n=0;n<e.state.tradeData[a].bids.length;n++)if(e.state.tradeData[a].bids[n]==t.key){e.state.tradeData[a].bids.splice(n,1),0==n&&e.state.tradeData[a].bids.length>0&&e.updatePrice("BidPrice",e.state.tradeData[a].Bid[e.state.tradeData[a].bids[n]].price,a);break}},function(e){return console.log("trade bid "+e)}),r.on("child_added",function(t){if(e.state.tradeData[a].Ask[t.key]=t.val(),0==e.state.tradeData[a].asks.length)e.state.tradeData[a].asks.push(t.key),e.updatePrice("AskPrice",t.val().price,a);else{var n=!1,s=e.state.tradeData[a].asks.length;console.log("start with "+e.state.tradeData[a].asks);for(var r=0;r<s;r++){if(console.log("Ask "+r),t.val().price<e.state.tradeData[a].Ask[e.state.tradeData[a].asks[r]].price){console.log("smaller"),e.state.tradeData[a].asks.splice(r,0,t.key),n=!0,0==r&&(console.log("first"),e.updatePrice("AskPrice",t.val().price,a));break}console.log("loop == "+e.state.tradeData[a].asks)}n||(console.log("last"),e.state.tradeData[a].asks.push(t.key)),console.log("last is "+e.state.tradeData[a].asks)}},function(e){return console.log("trade ask "+e)}),r.on("child_changed",function(t){e.state.tradeData[a].Ask[t.key]=t.val()},function(e){return console.log("trade ask "+e)}),r.on("child_removed",function(t){e.state.tradeData[a].Ask[t.key]=void 0;for(var n=0;n<e.state.tradeData[a].asks.length;n++)if(e.state.tradeData[a].asks[n]==t.key){e.state.tradeData[a].asks.splice(n,1),0==n&&e.state.tradeData[a].asks.length>0&&e.updatePrice("AskPrice",e.state.tradeData[a].Ask[e.state.tradeData[a].asks[n]].price,a);break}},function(e){return console.log("trade ask "+e)})})}},{key:"routePush",value:function(e){this.props.history.push(e)}},{key:"tick",value:function(){this.setState(function(e){return{seconds:e.seconds+1}})}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return e.tick()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"reset",value:function(){this.setState({seconds:0})}},{key:"contract",value:function(){this.nation=[],this.target=[],this.nation.push(this.state.nationChosen1),this.nation.push(this.state.nationChosen2);for(var e=0;e<this.nationOptions.length;e++)this.nationOptions[e]!=this.state.nationChosen1&&this.nationOptions[e]!=this.state.nationChosen2&&this.target.push(this.nationOptions[e]);this.setState({rules:[],contracting:!0})}},{key:"contracting",value:function(){var e=this;if(this.state.contracting)return s.a.createElement("div",null,s.a.createElement(M.a,null,s.a.createElement(E.a,{xs:1,md:1,lg:1}),s.a.createElement(E.a,{xs:4,md:4,lg:4},s.a.createElement("form",{onSubmit:null},s.a.createElement(x.a,{controlId:"expiry",bsSize:"large"},s.a.createElement(C.a,null,"Expiry Session"),s.a.createElement(O.a,{value:this.state.expiry,onChange:this._handleExpiryChange,type:"number"})))),s.a.createElement(E.a,{xs:1,md:1,lg:1}),s.a.createElement(E.a,{xs:1,md:1,lg:1}),s.a.createElement(E.a,{xs:4,md:4,lg:4},s.a.createElement("form",{onSubmit:null},s.a.createElement(x.a,{controlId:"penalty",bsSize:"large"},s.a.createElement(C.a,null,"Penalty"),s.a.createElement(O.a,{value:this.state.penalty,onChange:this._handlePenaltyChange,type:"number"})))),s.a.createElement(E.a,{xs:1,md:1,lg:1})),s.a.createElement(M.a,null,s.a.createElement(E.a,{xs:3,md:3,lg:3},s.a.createElement(D.a,{options:this.nation,onChange:this.__selectNation,value:this.state.from,placeholder:"Select an option"})),s.a.createElement(E.a,{xs:1,md:1,lg:1}," WITH "),s.a.createElement(E.a,{xs:3,md:3,lg:3},s.a.createElement(D.a,{options:this.target,onChange:this.__selectTarget,value:this.state.to,placeholder:"Select an option"})),s.a.createElement(E.a,{xs:1,md:1,lg:1}," CAN'T Trade "),s.a.createElement(E.a,{xs:2,md:2,lg:2},s.a.createElement(D.a,{options:_.Master.resourcesOrder,onChange:this.__selectResouce,value:this.state.resource,placeholder:"Select an option"})),s.a.createElement(E.a,{xs:2,md:2,lg:2},s.a.createElement(A.a,{className:"Button",bsStyle:"warning",bsSize:"small",onClick:function(){return e.addRule()}},"Add Rule"))))}},{key:"addRule",value:function(){this.state.rules.push({from:this.state.from,target:this.state.to,resource:this.state.resource}),this.setState()}},{key:"renderRules",value:function(e,t){return s.a.createElement(M.a,{className:"Rules",key:t},e.from.label," can't trade ",e.resource.value," and its related product with ",e.target.label)}},{key:"initiateRulesButton",value:function(){var e=this;if(this.state.contracting&&this.state.rules.length>0&&this.state.expiry>this.state.session)return s.a.createElement(M.a,null,s.a.createElement(A.a,{className:"Button",bsStyle:"warning",bsSize:"large",onClick:function(){return e.initiateRules()}},"Add Contract"))}},{key:"contractRuin",value:function(){var e=Object(f.a)(S.a.mark(function e(t,a,n){var s,r,i,o;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=b.database().ref().child("contract/"+t),r=!0,e.next=4,b.database().ref().child("users/"+a+"/resources/Money").transaction(function(e){return null!=e&&(e>=this.contractList[t].penalty?e-=this.contractList[t].penalty:r=!1),e}.bind(this));case 4:i=e.sent;case 5:if(i.committed){e.next=11;break}return e.next=8,b.database().ref().child("users/"+a+"/resources/Money").transaction(function(e){return null!=e&&(e>=this.contractList[t].penalty?e-=this.contractList[t].penalty:r=!1),e}.bind(this));case 8:i=e.sent,e.next=5;break;case 11:return e.next=13,b.database().ref().child("users/"+n+"/resources/Money").transaction(function(e){return null!=e&&r&&(e+=this.contractList[t].penalty),e}.bind(this));case 13:o=e.sent;case 14:if(o.committed){e.next=20;break}return e.next=17,b.database().ref().child("users/"+n+"/resources/Money").transaction(function(e){return null!=e&&r&&(e+=this.contractList[t].penalty),e}.bind(this));case 17:o=e.sent,e.next=14;break;case 20:return e.next=22,b.database().ref().child("publicNews").transaction(function(e){return null==e&&(e={}),e[Date.now().toString()]={title:"Contract Ruin",info:this.nationMap[a].name+" have violated contract "+t+", penalty "+(r?"have been charged.":"have not been charged due to not enough amount in treasury."),from:"World Trade Organisation"},e}.bind(this));case 22:if(e.sent,!r){e.next=31;break}return e.next=26,s.transaction(function(e){return null!=e&&(e.expiry=this.state.session-1),console.log(JSON.stringify(e)),e}.bind(this));case 26:e.sent,console.log("contract end"),alert("contract end, penalty have been paid"),e.next=32;break;case 31:alert("no enough money to pay the penalty");case 32:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"endContract",value:function(){var e=Object(f.a)(S.a.mark(function e(t){var a,n,s,r,i;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.database().ref().child("contract/"+t),n=!0,s=Object.keys(this.contractList[t].parties),e.next=5,b.database().ref().child("users").child(s[0]).child("resources/Money").once("value");case 5:return r=e.sent,e.next=8,b.database().ref().child("users").child(s[0]).child("resources/Money").once("value");case 8:if(i=e.sent,(r.val()<0||i.val()<0)&&(n=!1),!n){e.next=22;break}return e.next=13,b.database().ref().child("users").child(s[0]).child("resources/Money").transaction(function(e){return null!=e&&(e-=0),e});case 13:return e.next=15,b.database().ref().child("users").child(s[1]).child("resources/Money").transaction(function(e){return null!=e&&(e-=0),e});case 15:return e.next=17,a.transaction(function(e){return null!=e&&(e.expiry=this.state.session-1),console.log(JSON.stringify(e)),e}.bind(this));case 17:e.sent,console.log("contract end"),alert("contract end"),e.next=23;break;case 22:alert("no enough money");case 23:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"endContractByOne",value:function(){var e=Object(f.a)(S.a.mark(function e(t,a){var n,s;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.database().ref().child("contract/"+t),s=!0,Object.keys(this.contractList[t].parties),e.next=5,b.database().ref().child("users").child(a).child("resources/Money").once("value");case 5:if(e.sent.val()<2e4&&(s=!1),!s){e.next=17;break}return e.next=10,b.database().ref().child("users").child(a).child("resources/Money").transaction(function(e){return null!=e&&(e-=2e4),e});case 10:return e.next=12,n.transaction(function(e){return null!=e&&(e.expiry=this.state.session-1),console.log(JSON.stringify(e)),e}.bind(this));case 12:e.sent,console.log("contract end"),alert("contract end"),e.next=18;break;case 17:alert("no enough money");case 18:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},s.a.createElement("div",{className:"Body"},s.a.createElement(E.a,{xs:1,md:1,lg:1,className:"SideBar"},this.state.login?s.a.createElement("div",null,s.a.createElement(A.a,{className:"Button",bsStyle:"success",bsSize:"small",onClick:function(){return e.logout()}},"LOGOUT"),s.a.createElement(A.a,{className:"Button",bsStyle:"primary",bsSize:"small",onClick:function(){return e.endSession()}},"END SESSION"),s.a.createElement(A.a,{className:"Button",bsStyle:"primary",bsSize:"small",onClick:function(){return e.collectResources()}},"COLLECT RESOURCES"),s.a.createElement(A.a,{className:"Button",bsStyle:"primary",bsSize:"small",onClick:function(){return e.addUser()}},"ADD USER")):s.a.createElement("div",{className:"Login"},s.a.createElement("form",{onSubmit:this.handleLoginSubmit},s.a.createElement(x.a,{controlId:"email",bsSize:"large"},s.a.createElement(C.a,null,"Email"),s.a.createElement(O.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleLoginChange})),s.a.createElement(x.a,{controlId:"password",bsSize:"large"},s.a.createElement(C.a,null,"Password"),s.a.createElement(O.a,{value:this.state.password,onChange:this.handleLoginChange,type:"password"})),s.a.createElement(A.a,{block:!0,bsSize:"large",disabled:!this.validateLoginForm(),type:"submit"},"Login")))),s.a.createElement(E.a,{xs:11,md:11,lg:11,className:"MainContent"},s.a.createElement(M.a,{xs:11,md:11,lg:11},s.a.createElement("header",{className:"App-header"},s.a.createElement("h1",null," Session : ",this.state.session," "))),s.a.createElement(E.a,{xs:6,md:6,lg:6},s.a.createElement(W.a,{gutterBottom:!0,variant:"subtitle1",style:{fontSize:20,color:"#444444"}},"VIOLATED CONTRACT"),s.a.createElement("div",{className:"ListView"},Object.keys(this.contractList).map(function(t){return s.a.createElement(e.renderContractList,{data:e.contractList[t],key:t,theKey:t})}))),s.a.createElement(E.a,{xs:6,md:6,lg:6},s.a.createElement(M.a,null,s.a.createElement(E.a,{xs:6,md:6,lg:6},s.a.createElement(D.a,{options:this.nationOptions,onChange:this._onSelectNation1,value:this.state.nationChosen1,placeholder:"Select an option"})),s.a.createElement(E.a,{xs:6,md:6,lg:6},s.a.createElement(D.a,{options:this.nationOptions,onChange:this._onSelectNation2,value:this.state.nationChosen2,placeholder:"Select an option"}))),this.validation(),this.contracting(),this.state.rules.map(this.renderRules),this.initiateRulesButton()))))}}]),t}(n.Component)),T=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"logout",value:function(){b.auth().signOut(),console.log("Sign Out")}},{key:"render",value:function(){return s.a.createElement(g.a,null,s.a.createElement(p.a,null,s.a.createElement(m.a,{path:"/nyes-contract/",component:N,exact:!0}),s.a.createElement(m.a,{component:H})))}}]),t}(n.Component),H=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("p",null,"No Exist")}}]),t}(n.Component),z=T;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},47:function(e,t){t.Master={resourcesOrder:["Wood","Sand","Steel","Rubber","Cotton","Oil","Leather","Copper","Silver","Vegetable","Meat","Car","Shirt","Processed Vegetable","Processed Meat","Solar Panel","Furniture","Jewellery","Gloves","Bag","Gadget","Book"],initialMatrix:{Wood:!1,Sand:!1,Steel:!1,Rubber:!1,Cotton:!1,Oil:!1,Leather:!1,Copper:!1,Silver:!1,Vegetable:!1,Meat:!1,Car:!1,Shirt:!1,"Processed Vegetable":!1,"Processed Meat":!1,"Solar Panel":!1,Furniture:!1,Jewellery:!1,Gloves:!1,Bag:!1,Gadget:!1,Book:!1},resources:{Wood:{price:5,img:"packages/e_nation/Assets/resources/wood.png"},Sand:{price:5,img:"packages/e_nation/Assets/resources/sand.png"},Steel:{price:20,img:"packages/e_nation/Assets/resources/steel.png"},Rubber:{price:4,img:"packages/e_nation/Assets/resources/Rubber.jpg"},Cotton:{price:2,img:"packages/e_nation/Assets/resources/Cotton.jpg"},Oil:{price:125,img:"packages/e_nation/Assets/resources/Oil.jpg"},Leather:{price:15,img:"packages/e_nation/Assets/resources/Leather.png"},Copper:{price:30,img:"packages/e_nation/Assets/resources/copper.png"},Silver:{price:250,img:"packages/e_nation/Assets/resources/Silver.png"},Vegetable:{price:3,feed:1,img:"packages/e_nation/Assets/resources/Vegetable.png"},Meat:{price:5,feed:2,img:"packages/e_nation/Assets/resources/Meat.png"},Car:{price:80,img:"packages/e_nation/Assets/resources/Car.jpg"},Shirt:{price:5,img:"packages/e_nation/Assets/resources/wood.png"},"Processed Vegetable":{price:10,feed:2,img:"packages/e_nation/Assets/resources/wood.png"},"Processed Meat":{price:14,feed:3,img:"packages/e_nation/Assets/resources/wood.png"},"Solar Panel":{price:25,img:"packages/e_nation/Assets/resources/wood.png"},Furniture:{price:20,img:"packages/e_nation/Assets/resources/wood.png"},Jewellery:{price:40,img:"packages/e_nation/Assets/resources/wood.png"},Gloves:{price:16,img:"packages/e_nation/Assets/resources/wood.png"},Bag:{price:20,img:"packages/e_nation/Assets/resources/wood.png"},Gadget:{price:28,img:"packages/e_nation/Assets/resources/wood.png"},Book:{price:10,img:"packages/e_nation/Assets/resources/wood.png"}},building:{Wood:{rate:{base:3,upgrade:1.5},input:{Money:7.5},upgrade:[{human:2500,Wood:3e3,Sand:3e3,Steel:1500,Money:2e4},{human:2e3,Wood:8e3,Sand:8e3,Steel:4e3,Money:5e4}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Sand:{rate:{base:3,upgrade:1.5},input:{Money:7.5},upgrade:[{human:2500,Wood:3e3,Sand:3e3,Steel:1500,Money:2e4},{human:2e3,Wood:8e3,Sand:8e3,Steel:4e3,Money:5e4}],maxHuman:1e3,img:"Assets/building/quarry.jpg"},Steel:{rate:{base:1.5,upgrade:.75},input:{Money:15},upgrade:[{human:2500,Wood:5e3,Sand:5e3,Steel:2e3,Money:37500},{human:2e3,Wood:8e3,Sand:8e3,Steel:4e3,Money:55e3}],maxHuman:1e3,img:"Assets/building/steel.png"},Rubber:{rate:{base:3,upgrade:1.5},input:{Money:5},upgrade:[{human:2500,Wood:4e3,Sand:4e3,Steel:800,Money:2e4},{human:2e3,Wood:8e3,Sand:8e3,Steel:1500,Money:45e3}],maxHuman:1e3,img:"Assets/building/Rubber.jpg"},Cotton:{rate:{base:8.5,upgrade:4.25},input:{Money:7.5},upgrade:[{human:2500,Wood:3500,Sand:3500,Steel:800,Money:3e4},{human:2e3,Wood:8e3,Sand:8e3,Steel:1500,Money:6e4}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Oil:{rate:{base:10,upgrade:0},input:{Money:500},upgrade:[{human:2500,Wood:1200,Sand:1200,Money:25e5},{human:2e3,Wood:700,Sand:700,Money:2e6,"R&D":1}],maxHuman:1200,img:"Assets/building/logging.jpg"},Leather:{rate:{base:1.5,upgrade:1},input:{Money:12},upgrade:[{human:2500,Wood:4e3,Sand:4e3,Steel:2500,Money:3e4},{human:2e3,Wood:8e3,Sand:8e3,Steel:5e3,Money:75e3}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Copper:{rate:{base:1.3,upgrade:1.3},input:{Money:20},upgrade:[{human:2500,Wood:5e3,Sand:5e3,Steel:3500,Money:55e3},{human:2500,Wood:11e3,Sand:11e3,Steel:8e3,Money:13e4}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Silver:{rate:{base:.5,upgrade:.5},input:{Money:50},upgrade:[{human:2500,Wood:1e4,Sand:1e4,Steel:5e3,Money:2e5},{human:2e3,Wood:12500,Sand:12500,Steel:8e3,Money:35e4,"R&D":1}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Vegetable:{rate:{base:3,upgrade:.6},input:{Money:5},upgrade:[{human:2500,Wood:3e3,Sand:3e3,Steel:1500,Money:25e3},{human:2e3,Wood:8e3,Sand:8e3,Steel:4e3,Money:5e4}],maxHuman:1e3,img:"Assets/building/quarry.jpg"},Meat:{rate:{base:3,upgrade:.9},input:{Money:8.5},upgrade:[{human:2500,Wood:4500,Sand:4500,Steel:2500,Money:35e3},{human:2e3,Wood:8e3,Sand:8e3,Steel:6e3,Money:65e3}],maxHuman:1e3,img:"Assets/building/quarry.jpg"},Car:{rate:{base:2,upgrade:0},input:{Money:16,Steel:2,Sand:4,Rubber:3},upgrade:[{human:2500,Wood:1200,Sand:1500,Money:4e6},{human:2e3,Wood:1e3,Sand:1200,Money:3e6,"R&D":1}],maxHuman:500,img:"Assets/building/logging.jpg"},Shirt:{rate:{base:25,upgrade:0},input:{Money:8,Cotton:50},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:2e6,"R&D":1}],maxHuman:500,img:"Assets/building/logging.jpg"},"Processed Vegetable":{rate:{base:16,upgrade:0},input:{Money:10.5,Vegetable:7.5,Oil:16,Rubber:1.8},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:2e6}],maxHuman:500,img:"Assets/building/logging.jpg"},"Processed Meat":{rate:{base:16,upgrade:0},input:{Money:10.5,Meat:6,Oil:16,Rubber:1.8},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:2e6}],maxHuman:500,img:"Assets/building/logging.jpg"},"Solar Panel":{rate:{base:4,upgrade:0},input:{Money:12,Steel:2,Rubber:4,Cooper:1},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:2e6},{human:2e3,Steel:1e3,Sand:1200,Money:25e5,"R&D":1}],maxHuman:500,img:"Assets/building/logging.jpg"},Furniture:{rate:{base:3,upgrade:0},input:{Money:12,Cotton:24,Steel:2,Wood:2.4},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:2e6,"R&D":1}],maxHuman:500,img:"Assets/building/logging.jpg"},Jewellery:{rate:{base:.6,upgrade:0},input:{Money:8,Silver:.8},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:35e5},{human:2e3,Steel:1e3,Sand:1200,Money:3e6,"R&D":1}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Gloves:{rate:{base:1,upgrade:0},input:{Money:6.25,Rubber:1.75},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:2e6,"R&D":1}],maxHuman:800,img:"Assets/building/logging.jpg"},Bag:{rate:{base:1.5,upgrade:0},input:{money:6.875,Cotton:10,Leather:1.25},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:23e5},{human:2e3,Steel:1e3,Sand:1200,Money:18e5,"R&D":1}],maxHuman:800,img:"Assets/building/logging.jpg"},Gadget:{rate:{base:2,upgrade:0},input:{Money:7,Steel:2,Copper:1.5,Sand:1.5},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:35e5},{human:2e3,Steel:1e3,Sand:1200,Money:25e5,"R&D":1}],maxHuman:1e3,img:"Assets/building/logging.jpg"},Book:{rate:{base:3,upgrade:0},input:{Money:40/7,Wood:12/7},upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:15e5,"R&D":1}],maxHuman:700,img:"Assets/building/logging.jpg"}},specialBuilding:{Education:{upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:15e5}],img:"Assets/specialBuilding/education.jpg",description:""},Healthcare:{upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:15e5,"R&D":1}],img:"Assets/specialBuilding/healthcare.jpg",description:""},Telecommunication:{upgrade:[{human:2500,Steel:1200,Sand:1500,Money:25e5},{human:2e3,Steel:1e3,Sand:1200,Money:15e5,"R&D":1}],img:"Assets/specialBuilding/telecommunication.jpg",description:""}}},t.initialTradeData={Wood:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Sand:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Steel:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Rubber:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Cotton:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Oil:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Leather:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Copper:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Silver:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Vegetable:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Meat:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Car:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Shirt:{bids:[],asks:[],price:{},Bid:{},Ask:{}},"Processed Vegetable":{bids:[],asks:[],price:{},Bid:{},Ask:{}},"Processed Meat":{bids:[],asks:[],price:{},Bid:{},Ask:{}},"Solar Panel":{bids:[],asks:[],price:{},Bid:{},Ask:{}},Furniture:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Jewellery:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Gloves:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Bag:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Gadget:{bids:[],asks:[],price:{},Bid:{},Ask:{}},Book:{bids:[],asks:[],price:{},Bid:{},Ask:{}}}},59:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},95:function(e,t,a){e.exports=a(235)}},[[95,2,1]]]);
//# sourceMappingURL=main.57299526.chunk.js.map